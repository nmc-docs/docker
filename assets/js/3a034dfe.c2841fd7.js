"use strict";(self.webpackChunknextjs=self.webpackChunknextjs||[]).push([[159],{6971:(n,e,c)=>{c.r(e),c.d(e,{assets:()=>d,contentTitle:()=>s,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"reference/docker-file","title":"Dockerfile","description":"\ud83d\udcc4 Dockerfile h\u1ed7 tr\u1ee3 c\xe1c t\u1eeb kh\xf3a sau:","source":"@site/docs/reference/docker-file.md","sourceDirName":"reference","slug":"/reference/docker-file","permalink":"/docker/reference/docker-file","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"docker run","permalink":"/docker/reference/cli/docker-run"}}');var r=c(4848),h=c(8453);const l={sidebar_position:2},s="Dockerfile",d={},t=[{value:"COPY",id:"copy",level:2},{value:"\ud83d\udee0\ufe0f C\xe1c t\xf9y ch\u1ecdn (options)",id:"\ufe0f-c\xe1c-t\xf9y-ch\u1ecdn-options",level:3},{value:"1. <code>--chown=&lt;user&gt;:&lt;group&gt;</code>",id:"1---chownusergroup",level:4},{value:"2. <code>--chmod=[permission]</code>",id:"2---chmodpermission",level:4},{value:"3. <code>--from=&lt;stage&gt;</code>",id:"3---fromstage",level:4},{value:"<code>&lt;src&gt;</code>",id:"src",level:3},{value:"<code>&lt;dest&gt;</code>",id:"dest",level:3},{value:"ENV",id:"env",level:2},{value:"S\u1eed d\u1ee5ng bi\u1ebfn m\xf4i tr\u01b0\u1eddng trong c\xe1c l\u1ec7nh k\u1ebf ti\u1ebfp:",id:"s\u1eed-d\u1ee5ng-bi\u1ebfn-m\xf4i-tr\u01b0\u1eddng-trong-c\xe1c-l\u1ec7nh-k\u1ebf-ti\u1ebfp",level:3},{value:"Thay \u0111\u1ed5i gi\xe1 tr\u1ecb c\u1ee7a bi\u1ebfn m\xf4i tr\u01b0\u1eddng khi ch\u1ea1y container:",id:"thay-\u0111\u1ed5i-gi\xe1-tr\u1ecb-c\u1ee7a-bi\u1ebfn-m\xf4i-tr\u01b0\u1eddng-khi-ch\u1ea1y-container",level:3},{value:"ARG",id:"arg",level:2},{value:"Thay \u0111\u1ed5i gi\xe1 tr\u1ecb <code>ARG</code> khi build",id:"thay-\u0111\u1ed5i-gi\xe1-tr\u1ecb-arg-khi-build",level:3},{value:"S\u1eed d\u1ee5ng <code>ARG</code> trong <code>FROM</code>:",id:"s\u1eed-d\u1ee5ng-arg-trong-from",level:3},{value:"K\u1ebft h\u1ee3p v\u1edbi <code>ENV</code>:",id:"k\u1ebft-h\u1ee3p-v\u1edbi-env",level:3},{value:"\ud83d\udccc V\xed d\u1ee5 \u0111\u1ea7y \u0111\u1ee7:",id:"-v\xed-d\u1ee5-\u0111\u1ea7y-\u0111\u1ee7",level:3},{value:"FROM",id:"from",level:2},{value:"USER",id:"user",level:2},{value:"EXPOSE",id:"expose",level:2},{value:"CMD",id:"cmd",level:2},{value:"ENTRYPOINT",id:"entrypoint",level:2},{value:"V\xed d\u1ee5 1:",id:"v\xed-d\u1ee5-1",level:3},{value:"V\xed d\u1ee5 2:",id:"v\xed-d\u1ee5-2",level:3},{value:"RUN",id:"run",level:2}];function o(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,h.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"dockerfile",children:"Dockerfile"})}),"\n",(0,r.jsx)(e.p,{children:"\ud83d\udcc4 Dockerfile h\u1ed7 tr\u1ee3 c\xe1c t\u1eeb kh\xf3a sau:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"T\u1eeb kh\xf3a"}),(0,r.jsx)(e.th,{children:"M\xf4 t\u1ea3"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#arg",children:(0,r.jsx)(e.code,{children:"ARG"})})}),(0,r.jsx)(e.td,{children:"S\u1eed d\u1ee5ng bi\u1ebfn l\xfac build image"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#cmd",children:(0,r.jsx)(e.code,{children:"CMD"})})}),(0,r.jsx)(e.td,{children:"Ch\u1ec9 \u0111\u1ecbnh l\u1ec7nh ch\u1ea1y m\u1eb7c \u0111\u1ecbnh khi image \u0111\u01b0\u1ee3c ch\u1ea1y trong container"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#copy",children:(0,r.jsx)(e.code,{children:"COPY"})})}),(0,r.jsx)(e.td,{children:"Copy file v\xe0 th\u01b0 m\u1ee5c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#entrypoint",children:(0,r.jsx)(e.code,{children:"ENTRYPOINT"})})}),(0,r.jsx)(e.td,{children:"Ch\u1ec9 \u0111\u1ecbnh l\u1ec7nh th\u1ef1c thi m\u1eb7c \u0111\u1ecbnh"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#env",children:(0,r.jsx)(e.code,{children:"ENV"})})}),(0,r.jsx)(e.td,{children:"Thi\u1ebft l\u1eadp bi\u1ebfn m\xf4i tr\u01b0\u1eddng"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#expose",children:(0,r.jsx)(e.code,{children:"EXPOSE"})})}),(0,r.jsx)(e.td,{children:"M\xf4 t\u1ea3 c\u1ed5ng m\xe0 \u1ee9ng d\u1ee5ng c\u1ee7a ta \u0111ang l\u1eafng nghe."})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#from",children:(0,r.jsx)(e.code,{children:"FROM"})})}),(0,r.jsx)(e.td,{children:"T\u1ea1o m\u1edbi m\u1ed9t build stage t\u1eeb m\u1ed9t base image"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#healthcheck",children:(0,r.jsx)(e.code,{children:"HEALTHCHECK"})})}),(0,r.jsx)(e.td,{children:"Ki\u1ec3m tra t\xecnh tr\u1ea1ng c\u1ee7a container khi kh\u1edfi \u0111\u1ed9ng."})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#label",children:(0,r.jsx)(e.code,{children:"LABEL"})})}),(0,r.jsx)(e.td,{children:"Th\xeam metadata v\xe0o image"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#maintainer-deprecated",children:(0,r.jsx)(e.code,{children:"MAINTAINER"})})}),(0,r.jsx)(e.td,{children:"Ch\u1ec9 \u0111\u1ecbnh t\xe1c gi\u1ea3 t\u1ea1o ra\xa0image."})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#run",children:(0,r.jsx)(e.code,{children:"RUN"})})}),(0,r.jsx)(e.td,{children:"Execute build commands."})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#user",children:(0,r.jsx)(e.code,{children:"USER"})})}),(0,r.jsx)(e.td,{children:"Thi\u1ebft l\u1eadp user, group ID trong m\xf4i tr\u01b0\u1eddng container"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"#workdir",children:(0,r.jsx)(e.code,{children:"WORKDIR"})})}),(0,r.jsx)(e.td,{children:"Ch\u1ec9 \u0111\u1ecbnh th\u01b0 m\u1ee5c l\xe0m vi\u1ec7c"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"copy",children:"COPY"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["C\xe2u l\u1ec7nh ",(0,r.jsx)(e.code,{children:"COPY"})," d\xf9ng \u0111\u1ec3 ch\xe9p c\xe1c file code, th\u01b0 vi\u1ec7n, d\u1eef li\u1ec7u c\u1ea7n thi\u1ebft t\u1eeb th\u01b0 m\u1ee5c project v\xe0o trong image."]}),"\n",(0,r.jsxs)(e.li,{children:["C\xe2u l\u1ec7nh ",(0,r.jsx)(e.code,{children:"COPY"})," c\xf3 2 c\xe1ch vi\u1ebft, c\xe1ch vi\u1ebft th\u1ee9 hai \xe1p d\u1ee5ng cho c\xe1c \u0111\u01b0\u1eddng d\u1eabn ch\u1ee9a d\u1ea5u c\xe1ch:"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'COPY [OPTIONS] <src> ... <dest>\nCOPY [OPTIONS] ["<src>", ... "<dest>"]\n'})}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:"Option"})})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--from"})})}),(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--chown"})})}),(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--chmod"})})})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\ufe0f-c\xe1c-t\xf9y-ch\u1ecdn-options",children:"\ud83d\udee0\ufe0f C\xe1c t\xf9y ch\u1ecdn (options)"}),"\n",(0,r.jsxs)(e.h4,{id:"1---chownusergroup",children:["1. ",(0,r.jsx)(e.code,{children:"--chown=<user>:<group>"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Ch\u1ec9 \u0111\u1ecbnh ",(0,r.jsx)(e.strong,{children:"user v\xe0 group ownership"})," c\u1ee7a file/folder khi copy v\xe0o image."]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"COPY --chown=appuser:appgroup . /app\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["H\u1eefu \xedch khi ta kh\xf4ng mu\u1ed1n file m\u1eb7c \u0111\u1ecbnh l\xe0 ",(0,r.jsx)(e.code,{children:"root"})," trong container."]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h4,{id:"2---chmodpermission",children:["2. ",(0,r.jsx)(e.code,{children:"--chmod=[permission]"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Ch\u1ec9 \u0111\u1ecbnh quy\u1ec1n truy c\u1eadp c\u1ee7a file sau khi sao ch\xe9p v\xe0o container. Gi\xe1 tr\u1ecb c\xf3 th\u1ec3 l\xe0 m\u1ed9t trong c\xe1c d\u1ea1ng:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Ch\u1ebf \u0111\u1ed9 octal"})," (v\xed d\u1ee5: ",(0,r.jsx)(e.code,{children:"755"}),", ",(0,r.jsx)(e.code,{children:"644"}),")."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Ch\u1ebf \u0111\u1ed9 symbolic"})," (v\xed d\u1ee5: ",(0,r.jsx)(e.code,{children:"u+x"}),", ",(0,r.jsx)(e.code,{children:"a=r"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"# Sao ch\xe9p file nh\u01b0ng ch\u1ec9 c\u1ea5p quy\u1ec1n \u0111\u1ecdc cho t\u1ea5t c\u1ea3 ng\u01b0\u1eddi d\xf9ng (kh\xf4ng cho ph\xe9p s\u1eeda):\nCOPY --chmod=644 config.json /app/config.json\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h4,{id:"3---fromstage",children:["3. ",(0,r.jsx)(e.code,{children:"--from=<stage>"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["T\xf9y ch\u1ecdn ",(0,r.jsx)(e.code,{children:"--from"})," cho ph\xe9p ta ",(0,r.jsx)(e.strong,{children:"sao ch\xe9p file t\u1eeb m\u1ed9t stage kh\xe1c"})," trong qu\xe1 tr\xecnh build \u0111a giai \u0111o\u1ea1n."]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"COPY --from=<stage-name-or-index> <source_path> <destination_path>\n"})}),"\n",(0,r.jsx)(e.p,{children:"\ud83e\udde0 M\u1ee5c \u0111\xedch:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"T\u1ed1i \u01b0u h\xf3a k\xedch th\u01b0\u1edbc image:"})," Ch\u1ec9 sao ch\xe9p nh\u1eefng file c\u1ea7n thi\u1ebft t\u1eeb m\u1ed9t image build s\u1eb5n."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"T\xe1ch bi\u1ec7t c\xe1c b\u01b0\u1edbc build:"})," Ta c\xf3 th\u1ec3 build project trong m\u1ed9t stage, r\u1ed3i ch\u1ec9 copy k\u1ebft qu\u1ea3 (artifact) sang stage cu\u1ed1i c\xf9ng."]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u2705 V\xed d\u1ee5 minh h\u1ecda: Multi-stage build:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"# Stage 1: Build source code\nFROM node:20-alpine AS builder\nWORKDIR /app\nCOPY . .\nRUN npm install && npm run build\n\n# Stage 2: Production image\nFROM nginx:alpine\nCOPY --from=builder /app/dist /usr/share/nginx/html\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u1ede v\xed d\u1ee5 tr\xean:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"builder"})," l\xe0 t\xean stage \u0111\u1ea7u ti\xean."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"COPY --from=builder"})," s\u1ebd ch\u1ec9 copy th\u01b0 m\u1ee5c ",(0,r.jsx)(e.code,{children:"/app/dist"})," t\u1eeb image \u0111\xf3 v\xe0o image hi\u1ec7n t\u1ea1i."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"src",children:(0,r.jsx)(e.code,{children:"<src>"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u0110\u01b0\u1eddng d\u1eabn t\u1edbi t\u1ec7p ho\u1eb7c th\u01b0 m\u1ee5c ",(0,r.jsxs)(e.strong,{children:["t\u01b0\u01a1ng \u0111\u1ed1i v\u1edbi ",(0,r.jsx)(e.a,{href:"./cli/docker-build#-build-context-l%C3%A0-g%C3%AC",children:"build context"})]})," (th\u01b0\u1eddng l\xe0 th\u01b0 m\u1ee5c ta ch\u1ea1y ",(0,r.jsx)(e.code,{children:"docker build"})," t\u1eeb \u0111\xf3)."]}),"\n",(0,r.jsx)(e.li,{children:"C\xf3 th\u1ec3 l\xe0 m\u1ed9t ho\u1eb7c nhi\u1ec1u t\u1ec7p:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"COPY file1.txt file2.txt /usr/src/things/\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'COPY . /app\n# Copy t\u1ea5t c\u1ea3 file, th\u01b0 m\u1ee5c t\xednh t\u1eeb build context v\xe0o b\xean trong th\u01b0 m\u1ee5c "app" \u1edf image/container\n# Gi\u1ea3 s\u1eed th\u01b0 m\u1ee5c b\xean ngo\xe0i c\xf3 c\u1ea5u tr\xfac:\n.\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 index.js\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 src/\n    \u2514\u2500\u2500 app.js\n\n# Th\xec b\xean trong image/container:\n/app/\n\u251c\u2500\u2500 index.js\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 src/\n    \u2514\u2500\u2500 app.js\n\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'#Copy t\u1ea5t c\u1ea3 file, th\u01b0 m\u1ee5c b\xean trong th\u01b0 m\u1ee5c "src" v\xe0o b\xean trong th\u01b0 m\u1ee5c "/app/src" \u1edf image/container\nCOPY src/ /app/src/\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Ta c\u0169ng c\xf3 th\u1ec3 d\xf9ng wildcard (*, ?) gi\u1ed1ng nh\u01b0 glob:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'# Copy t\u1ea5t c\u1ea3 c\xe1c file .js \u1edf th\u01b0 m\u1ee5c "src" v\xe0o th\u01b0 m\u1ee5c "app" \u1edf container\nCOPY src/*.js /app/\n\n#Copy t\u1ea5t c\u1ea3 c\xe1c file .png v\xe0o th\u01b0 m\u1ee5c "dest" \u1edf container\nCOPY *.png /dest/\n'})}),"\n",(0,r.jsx)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["N\u1ebfu c\xf3 ",(0,r.jsx)(e.code,{children:".dockerignore"}),", nh\u1eefng file b\u1ecb li\u1ec7t k\xea trong \u0111\xf3 s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c copy."]}),"\n",(0,r.jsxs)(e.li,{children:["Docker s\u1eed d\u1ee5ng cache theo t\u1eebng l\u1ec7nh. N\u1ebfu file thay \u0111\u1ed5i, l\u1ec7nh ",(0,r.jsx)(e.code,{children:"COPY"})," s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n l\u1ea1i \u2192 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn hi\u1ec7u su\u1ea5t build."]}),"\n"]})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"dest",children:(0,r.jsx)(e.code,{children:"<dest>"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u0110\u01b0\u1eddng d\u1eabn \u0111\xedch b\xean trong image. C\xf3 th\u1ec3 l\xe0 th\u01b0 m\u1ee5c ho\u1eb7c file.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"N\u1ebfu l\xe0 th\u01b0 m\u1ee5c, c\xe1c file s\u1ebd \u0111\u01b0\u1ee3c copy v\xe0o b\xean trong th\u01b0 m\u1ee5c \u0111\xf3."}),"\n",(0,r.jsx)(e.li,{children:"N\u1ebfu th\u01b0 m\u1ee5c kh\xf4ng t\u1ed3n t\u1ea1i, Docker s\u1ebd t\u1ea1o ra."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"env",children:"ENV"}),"\n",(0,r.jsxs)(e.admonition,{type:"info",children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"ENV"})," trong Dockerfile \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \u0111\u1eb7t c\xe1c bi\u1ebfn m\xf4i tr\u01b0\u1eddng (environment variables) b\xean trong image, nh\u1eefng bi\u1ebfn n\xe0y s\u1ebd c\xf3 s\u1eb5n khi container \u0111\u01b0\u1ee3c ch\u1ea1y. \u0110i\u1ec1u n\xe0y gi\xfap ta c\u1ea5u h\xecnh c\xe1c \u1ee9ng d\u1ee5ng b\xean trong container ho\u1eb7c truy\u1ec1n th\xf4ng tin c\u1ea7n thi\u1ebft trong su\u1ed1t qu\xe1 tr\xecnh ch\u1ea1y c\u1ee7a container."]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"ENV <key>=<value> ...\n"})}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Trong \u0111\xf3:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"<key>"})}),": T\xean c\u1ee7a bi\u1ebfn m\xf4i tr\u01b0\u1eddng."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"<value>"})}),": Gi\xe1 tr\u1ecb c\u1ee7a bi\u1ebfn m\xf4i tr\u01b0\u1eddng."]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Ta c\xf3 th\u1ec3 ch\u1ec9 \u0111\u1ecbnh nhi\u1ec1u bi\u1ebfn m\xf4i tr\u01b0\u1eddng c\xf9ng m\u1ed9t l\xfac, m\u1ed7i bi\u1ebfn c\xe1ch nhau b\u1eb1ng d\u1ea5u c\xe1ch."}),"\n",(0,r.jsxs)(e.li,{children:["\ud83e\udde0 M\u1ee5c \u0111\xedch c\u1ee7a l\u1ec7nh ENV:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"C\u1ea5u h\xecnh container: Cung c\u1ea5p c\xe1c th\xf4ng s\u1ed1 nh\u01b0 c\u1ed5ng, th\u01b0 m\u1ee5c, ho\u1eb7c th\xf4ng tin c\u1ea5u h\xecnh kh\xe1c cho \u1ee9ng d\u1ee5ng."}),"\n",(0,r.jsx)(e.li,{children:"\u0110\u1ea3m b\u1ea3o t\xednh di \u0111\u1ed9ng: Gi\xfap Docker container c\xf3 th\u1ec3 ho\u1ea1t \u0111\u1ed9ng gi\u1ed1ng nhau tr\xean c\xe1c m\xf4i tr\u01b0\u1eddng kh\xe1c nhau, t\u1eeb m\xe1y t\xednh c\xe1 nh\xe2n, m\xe1y ch\u1ee7 \u0111\u1ebfn m\xf4i tr\u01b0\u1eddng cloud."}),"\n",(0,r.jsxs)(e.li,{children:["D\u1ec5 d\xe0ng thay \u0111\u1ed5i c\u1ea5u h\xecnh: Thay v\xec ph\u1ea3i thay \u0111\u1ed5i m\xe3 ngu\u1ed3n ho\u1eb7c ",(0,r.jsx)(e.strong,{children:"Dockerfile"}),", ta c\xf3 th\u1ec3 ch\u1ec9 c\u1ea7n thay \u0111\u1ed5i gi\xe1 tr\u1ecb c\u1ee7a bi\u1ebfn m\xf4i tr\u01b0\u1eddng khi ch\u1ea1y container."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"\ud83d\udd28 V\xed d\u1ee5 v\u1ec1 l\u1ec7nh ENV:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"ENV NODE_ENV=production\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 Bi\u1ebfn m\xf4i tr\u01b0\u1eddng ",(0,r.jsx)(e.code,{children:"NODE_ENV"})," s\u1ebd c\xf3 gi\xe1 tr\u1ecb l\xe0 ",(0,r.jsx)(e.strong,{children:"production"})," trong to\xe0n b\u1ed9 container khi n\xf3 \u0111ang ch\u1ea1y. C\xe1c \u1ee9ng d\u1ee5ng b\xean trong container c\xf3 th\u1ec3 s\u1eed d\u1ee5ng gi\xe1 tr\u1ecb n\xe0y \u0111\u1ec3 bi\u1ebft container \u0111ang ch\u1ea1y trong m\xf4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t."]}),"\n",(0,r.jsx)(e.h3,{id:"s\u1eed-d\u1ee5ng-bi\u1ebfn-m\xf4i-tr\u01b0\u1eddng-trong-c\xe1c-l\u1ec7nh-k\u1ebf-ti\u1ebfp",children:"S\u1eed d\u1ee5ng bi\u1ebfn m\xf4i tr\u01b0\u1eddng trong c\xe1c l\u1ec7nh k\u1ebf ti\u1ebfp:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Bi\u1ebfn m\xf4i tr\u01b0\u1eddng c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\xe1c l\u1ec7nh ti\u1ebfp theo trong ",(0,r.jsx)(e.strong,{children:"Dockerfile"}),":"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"ENV APP_HOME=/app\nWORKDIR $APP_HOME\nCOPY . $APP_HOME\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 \u1ede \u0111\xe2y, ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t bi\u1ebfn m\xf4i tr\u01b0\u1eddng ",(0,r.jsx)(e.code,{children:"APP_HOME"}),", sau \u0111\xf3 s\u1eed d\u1ee5ng n\xf3 trong l\u1ec7nh ",(0,r.jsx)(e.code,{children:"WORKDIR"})," v\xe0 ",(0,r.jsx)(e.code,{children:"COPY"})," \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh th\u01b0 m\u1ee5c l\xe0m vi\u1ec7c v\xe0 sao ch\xe9p m\xe3 ngu\u1ed3n v\xe0o th\u01b0 m\u1ee5c \u0111\xf3."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"thay-\u0111\u1ed5i-gi\xe1-tr\u1ecb-c\u1ee7a-bi\u1ebfn-m\xf4i-tr\u01b0\u1eddng-khi-ch\u1ea1y-container",children:"Thay \u0111\u1ed5i gi\xe1 tr\u1ecb c\u1ee7a bi\u1ebfn m\xf4i tr\u01b0\u1eddng khi ch\u1ea1y container:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Khi ta ch\u1ea1y container, ta c\xf3 th\u1ec3 ghi \u0111\xe8 gi\xe1 tr\u1ecb c\u1ee7a m\u1ed9t bi\u1ebfn m\xf4i tr\u01b0\u1eddng b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng t\xf9y ch\u1ecdn -e trong l\u1ec7nh docker run:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker run -e NODE_ENV=development myapp\n"})}),"\n",(0,r.jsxs)(e.p,{children:["Trong v\xed d\u1ee5 tr\xean, gi\xe1 tr\u1ecb c\u1ee7a ",(0,r.jsx)(e.code,{children:"NODE_ENV"})," s\u1ebd \u0111\u01b0\u1ee3c thay \u0111\u1ed5i th\xe0nh ",(0,r.jsx)(e.code,{children:"development"}),", d\xf9 trong Dockerfile n\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c \u0111\u1eb7t l\xe0 ",(0,r.jsx)(e.code,{children:"production"}),"."]}),"\n",(0,r.jsx)(e.h2,{id:"arg",children:"ARG"}),"\n",(0,r.jsxs)(e.admonition,{type:"info",children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"ARG"})," trong Dockerfile \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"\u0111\u1ecbnh ngh\u0129a c\xe1c bi\u1ebfn"})," m\xe0 c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c ",(0,r.jsx)(e.strong,{children:"s\u1eed d\u1ee5ng trong qu\xe1 tr\xecnh build"})," Docker image. C\xe1c bi\u1ebfn n\xe0y ch\u1ec9 c\xf3 hi\u1ec7u l\u1ef1c trong qu\xe1 tr\xecnh build v\xe0 ",(0,r.jsx)(e.strong,{children:"kh\xf4ng t\u1ed3n t\u1ea1i trong container"})," khi image \u0111\xe3 \u0111\u01b0\u1ee3c t\u1ea1o ra."]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"ARG <name>[=<default_value>]\n"})}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Trong \u0111\xf3:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"<name>"})})," : T\xean c\u1ee7a bi\u1ebfn."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"<default_value>"})})," (t\xf9y ch\u1ecdn): Gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh cho bi\u1ebfn n\u1ebfu kh\xf4ng \u0111\u01b0\u1ee3c cung c\u1ea5p khi build."]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\ud83e\udde0 M\u1ee5c \u0111\xedch c\u1ee7a ",(0,r.jsx)(e.code,{children:"ARG"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Thi\u1ebft l\u1eadp gi\xe1 tr\u1ecb c\u1ea5u h\xecnh build: Ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"ARG"})," \u0111\u1ec3 truy\u1ec1n c\xe1c gi\xe1 tr\u1ecb v\xe0o trong Dockerfile m\xe0 c\xf3 th\u1ec3 thay \u0111\u1ed5i \u0111\u01b0\u1ee3c trong qu\xe1 tr\xecnh build."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\ud83d\udd28 V\xed d\u1ee5 c\u01a1 b\u1ea3n v\u1ec1 ",(0,r.jsx)(e.code,{children:"ARG"}),":"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'# \u0110\u1ecbnh ngh\u0129a bi\u1ebfn ARG v\u1edbi gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh\nARG VERSION=1.0\n\n# S\u1eed d\u1ee5ng gi\xe1 tr\u1ecb c\u1ee7a ARG trong Dockerfile\nRUN echo "Building version ${VERSION}"\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 Khi build image, Docker s\u1ebd s\u1eed d\u1ee5ng gi\xe1 tr\u1ecb ",(0,r.jsx)(e.code,{children:"1.0"})," cho bi\u1ebfn ",(0,r.jsx)(e.code,{children:"VERSION"})," tr\u1eeb khi ta thay \u0111\u1ed5i n\xf3 khi ch\u1ea1y l\u1ec7nh build."]}),"\n",(0,r.jsxs)(e.h3,{id:"thay-\u0111\u1ed5i-gi\xe1-tr\u1ecb-arg-khi-build",children:["Thay \u0111\u1ed5i gi\xe1 tr\u1ecb ",(0,r.jsx)(e.code,{children:"ARG"})," khi build"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Khi build, ta c\xf3 th\u1ec3 ch\u1ec9 \u0111\u1ecbnh gi\xe1 tr\u1ecb c\u1ee7a ",(0,r.jsx)(e.code,{children:"ARG"})," qua tham s\u1ed1 ",(0,r.jsx)(e.code,{children:"--build-arg"}),"."]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker build --build-arg VERSION=2.0 .\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, Dockerfile s\u1ebd s\u1eed d\u1ee5ng gi\xe1 tr\u1ecb ",(0,r.jsx)(e.code,{children:"2.0"})," thay v\xec ",(0,r.jsx)(e.code,{children:"1.0"}),"."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"s\u1eed-d\u1ee5ng-arg-trong-from",children:["S\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"ARG"})," trong ",(0,r.jsx)(e.code,{children:"FROM"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"ARG"})," \u0111\u1ec3 thay \u0111\u1ed5i base image trong qu\xe1 tr\xecnh build:"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"ARG BASE_IMAGE=node:14\nFROM ${BASE_IMAGE}\n\n# Ti\u1ebfp t\u1ee5c c\xe1c l\u1ec7nh kh\xe1c...\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Khi build, ta c\xf3 th\u1ec3 ch\u1ec9 \u0111\u1ecbnh base image nh\u01b0 sau:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker build --build-arg BASE_IMAGE=node:16 .\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 Trong v\xed d\u1ee5 n\xe0y, Docker s\u1ebd s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"node:16"})," thay v\xec ",(0,r.jsx)(e.code,{children:"node:14"}),"."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"k\u1ebft-h\u1ee3p-v\u1edbi-env",children:["K\u1ebft h\u1ee3p v\u1edbi ",(0,r.jsx)(e.code,{children:"ENV"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["M\u1ed9t khi ",(0,r.jsx)(e.code,{children:"ARG"})," \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a, ta c\xf3 th\u1ec3 chuy\u1ec3n gi\xe1 tr\u1ecb c\u1ee7a n\xf3 sang m\u1ed9t bi\u1ebfn m\xf4i tr\u01b0\u1eddng (",(0,r.jsx)(e.code,{children:"ENV"}),") \u0111\u1ec3 s\u1eed d\u1ee5ng trong container khi n\xf3 ch\u1ea1y."]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'ARG VERSION=1.0\nENV VERSION=${VERSION}\n\nRUN echo "Running version ${VERSION}"\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, khi container \u0111\u01b0\u1ee3c ch\u1ea1y, gi\xe1 tr\u1ecb ",(0,r.jsx)(e.code,{children:"VERSION"})," s\u1ebd c\xf3 s\u1eb5n trong m\xf4i tr\u01b0\u1eddng container."]}),"\n",(0,r.jsx)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Bi\u1ebfn ",(0,r.jsx)(e.code,{children:"ARG"})," ch\u1ec9 c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong qu\xe1 tr\xecnh build. Sau khi image \u0111\xe3 \u0111\u01b0\u1ee3c t\u1ea1o ra, c\xe1c bi\u1ebfn ",(0,r.jsx)(e.code,{children:"ARG"})," s\u1ebd kh\xf4ng t\u1ed3n t\u1ea1i trong container."]}),"\n",(0,r.jsx)(e.li,{children:"N\u1ebfu kh\xf4ng ch\u1ec9 \u0111\u1ecbnh gi\xe1 tr\u1ecb khi build, Docker s\u1ebd s\u1eed d\u1ee5ng gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh (n\u1ebfu c\xf3)."}),"\n"]})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"-v\xed-d\u1ee5-\u0111\u1ea7y-\u0111\u1ee7",children:"\ud83d\udccc V\xed d\u1ee5 \u0111\u1ea7y \u0111\u1ee7:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'# \u0110\u1ecbnh ngh\u0129a ARG cho version v\xe0 base image\nARG VERSION=1.0\nARG BASE_IMAGE=node:14\n\n# Ch\u1ecdn base image \u0111\u1ed9ng\nFROM ${BASE_IMAGE}\n\n# \u0110\u1eb7t ENV t\u1eeb ARG\nENV APP_VERSION=${VERSION}\n\n# C\xe0i \u0111\u1eb7t dependencies v\xe0 sao ch\xe9p m\xe3 ngu\u1ed3n\nRUN npm install\nCOPY . /app\n\n# Ch\u1ea1y \u1ee9ng d\u1ee5ng\nCMD ["npm", "start"]\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Build command:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker build --build-arg VERSION=2.0 --build-arg BASE_IMAGE=node:16 .\n"})}),"\n",(0,r.jsx)(e.h2,{id:"from",children:"FROM"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Trong Dockerfile, l\u1ec7nh ",(0,r.jsx)(e.code,{children:"FROM"})," \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"ch\u1ec9 \u0111\u1ecbnh image g\u1ed1c (base image)"})," m\xe0 Docker s\u1ebd s\u1eed d\u1ee5ng l\xe0m n\u1ec1n t\u1ea3ng \u0111\u1ec3 x\xe2y d\u1ef1ng image m\u1edbi."]}),"\n",(0,r.jsxs)(e.li,{children:["M\u1ee5c \u0111\xedch ch\xednh c\u1ee7a FROM:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u2705 X\xe1c \u0111\u1ecbnh m\xf4i tr\u01b0\u1eddng c\u01a1 b\u1ea3n: v\xed d\u1ee5 Ubuntu, Alpine, Node.js, Python, v.v."}),"\n",(0,r.jsx)(e.li,{children:"\u2705 K\u1ebf th\u1eeba c\xe1c c\xf4ng c\u1ee5 v\xe0 th\u01b0 vi\u1ec7n c\xf3 s\u1eb5n trong image \u0111\xf3."}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 L\xe0 b\u01b0\u1edbc \u0111\u1ea7u ti\xean b\u1eaft bu\u1ed9c trong h\u1ea7u h\u1ebft c\xe1c Dockerfile (tr\u1eeb multistage build th\xec c\xf3 th\u1ec3 c\xf3 nhi\u1ec1u ",(0,r.jsx)(e.code,{children:"FROM"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"FROM node:18-alpine\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udc49 D\xf2ng n\xe0y n\xf3i r\u1eb1ng Docker s\u1ebd b\u1eaft \u0111\u1ea7u t\u1eeb image ",(0,r.jsx)(e.code,{children:"node"})," phi\xean b\u1ea3n ",(0,r.jsx)(e.code,{children:"18-alpine"}),", m\u1ed9t image nh\u1ecf g\u1ecdn \u0111\xe3 c\xe0i s\u1eb5n Node.js."]}),"\n",(0,r.jsx)(e.h2,{id:"user",children:"USER"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"USER"})," trong Dockerfile \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"thi\u1ebft l\u1eadp user (ng\u01b0\u1eddi d\xf9ng)"})," m\xe0 c\xe1c l\u1ec7nh sau \u0111\xf3 trong Dockerfile (v\xe0 container khi ch\u1ea1y) s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c thi d\u01b0\u1edbi quy\u1ec1n c\u1ee7a ng\u01b0\u1eddi d\xf9ng \u0111\xf3."]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"USER <username>[:<group>]\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\ud83e\udde0 M\u1ee5c \u0111\xedch:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"B\u1ea3o m\u1eadt"}),": Tr\xe1nh ch\u1ea1y container v\u1edbi quy\u1ec1n ",(0,r.jsx)(e.code,{children:"root"}),", h\u1ea1n ch\u1ebf nguy c\u01a1 t\u1ea5n c\xf4ng."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Ph\xe2n quy\u1ec1n"}),": D\xf9ng user ph\xf9 h\u1ee3p v\u1edbi \u1ee9ng d\u1ee5ng (v\xed d\u1ee5 ",(0,r.jsx)(e.code,{children:"node"}),", ",(0,r.jsx)(e.code,{children:"www-data"}),", v.v.)"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Chu\u1ea9n DevOps/SRE"}),": C\xe1c t\u1ed5 ch\u1ee9c th\u01b0\u1eddng kh\xf4ng cho ph\xe9p ch\u1ea1y container b\u1eb1ng ",(0,r.jsx)(e.code,{children:"root"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"V\xed d\u1ee5 1"}),": D\xf9ng user c\xf3 s\u1eb5n trong base image"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'FROM node:18-alpine\nWORKDIR /app\nCOPY . .\nRUN npm install\n\n# Chuy\u1ec3n sang user node (\u0111\xe3 c\xf3 s\u1eb5n trong node image)\nUSER node\n\nCMD ["node", "index.js"]\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"V\xed d\u1ee5 2"}),": T\u1ea1o user m\u1edbi r\u1ed3i d\xf9ng"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'FROM python:3.10-slim\n\n# T\u1ea1o user kh\xf4ng ph\u1ea3i root\nRUN useradd -m myuser\n\n# \u0110\u1eb7t user hi\u1ec7n t\u1ea1i\nUSER myuser\n\nCMD ["python", "app.py"]\n'})}),"\n",(0,r.jsx)(e.h2,{id:"expose",children:"EXPOSE"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"EXPOSE"})," trong Dockerfile d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"khai b\xe1o c\u1ed5ng (port)"})," m\xe0 container s\u1ebd ",(0,r.jsx)(e.strong,{children:"l\u1eafng nghe (listen)"})," khi ch\u1ea1y. \u0110\xe2y l\xe0 c\xe1ch ",(0,r.jsx)(e.strong,{children:"document h\xf3a"})," cho Docker v\xe0 ng\u01b0\u1eddi d\xf9ng bi\u1ebft \u1ee9ng d\u1ee5ng trong container ho\u1ea1t \u0111\u1ed9ng tr\xean c\u1ed5ng n\xe0o."]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"EXPOSE 3000\n"})}),"\n",(0,r.jsxs)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"EXPOSE"})," ",(0,r.jsx)(e.strong,{children:"kh\xf4ng t\u1ef1 \u0111\u1ed9ng m\u1edf c\u1ed5ng ra ngo\xe0i host"}),". N\xf3 ch\u1ec9 l\xe0 metadata \u0111\u1ec3 t\xe0i li\u1ec7u ho\xe1."]}),"\n",(0,r.jsxs)(e.li,{children:["\u0110\u1ec3 th\u1eadt s\u1ef1 ",(0,r.jsx)(e.strong,{children:"truy c\u1eadp t\u1eeb b\xean ngo\xe0i"})," , ta c\u1ea7n d\xf9ng ",(0,r.jsx)(e.code,{children:"-p"})," khi ch\u1ea1y container:"]}),"\n"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker run -p 8080:3000 my-image\n"})}),(0,r.jsx)(e.p,{children:"\ud83d\udc49 L\xfac n\xe0y:"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["C\u1ed5ng ",(0,r.jsx)(e.code,{children:"3000"})," trong container \u0111\u01b0\u1ee3c \xe1nh x\u1ea1 ra c\u1ed5ng ",(0,r.jsx)(e.code,{children:"8080"})," tr\xean m\xe1y host."]}),"\n",(0,r.jsxs)(e.li,{children:["Ta c\xf3 th\u1ec3 truy c\u1eadp app qua ",(0,r.jsx)(e.code,{children:"http://localhost:8080"}),"."]}),"\n"]})]}),"\n",(0,r.jsx)(e.h2,{id:"cmd",children:"CMD"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"CMD"})," trong Dockerfile \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"ch\u1ec9 \u0111\u1ecbnh l\u1ec7nh m\u1eb7c \u0111\u1ecbnh s\u1ebd \u0111\u01b0\u1ee3c ch\u1ea1y"})," khi container kh\u1edfi \u0111\u1ed9ng."]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'CMD ["executable", "param1", "param2"]\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'CMD ["node", "index.js"]\nCMD ["npm", "run", "dev"]\n'})}),"\n",(0,r.jsxs)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Trong m\u1ed9t Dockerfile ch\u1ec9 \u0111\u01b0\u1ee3c c\xf3 ",(0,r.jsx)(e.strong,{children:"m\u1ed9t d\xf2ng"})," ",(0,r.jsx)(e.code,{children:"CMD"})," (l\u1ec7nh sau s\u1ebd ghi \u0111\xe8 l\u1ec7nh tr\u01b0\u1edbc)."]}),"\n",(0,r.jsxs)(e.li,{children:["N\u1ebfu ta ch\u1ea1y ",(0,r.jsx)(e.code,{children:"docker run IMAGE l\u1ec7nh_m\u1edbi"})," , th\xec l\u1ec7nh \u0111\xf3 s\u1ebd ",(0,r.jsx)(e.strong,{children:"ghi \u0111\xe8 CMD"})," ."]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker run my-image node anotherFile.js\n"})}),(0,r.jsxs)(e.p,{children:["\u2192 L\u1ec7nh ",(0,r.jsx)(e.code,{children:"node anotherFile.js"})," s\u1ebd thay th\u1ebf ",(0,r.jsx)(e.code,{children:'CMD ["npm", "start"]'}),"."]})]}),"\n",(0,r.jsx)(e.h2,{id:"entrypoint",children:"ENTRYPOINT"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"ENTRYPOINT"})," trong Dockerfile d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"\u0111\u1ecbnh ngh\u0129a l\u1ec7nh ch\xednh (main command)"})," m\xe0 container ",(0,r.jsx)(e.strong,{children:"lu\xf4n lu\xf4n ch\u1ea1y khi kh\u1edfi \u0111\u1ed9ng"})," , ",(0,r.jsx)(e.strong,{children:"kh\xf4ng b\u1ecb ghi \u0111\xe8"})," b\u1edfi tham s\u1ed1 khi ch\u1ea1y ",(0,r.jsx)(e.code,{children:"docker run"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh n\xe0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p v\u1edbi l\u1ec7nh ",(0,r.jsx)(e.code,{children:"CMD"}),". Khi k\u1ebft h\u1ee3p, c\xe2u l\u1ec7nh th\u1ef1c thi s\u1ebd l\xe0 ",(0,r.jsx)(e.code,{children:"ENTRYPOINT + CMD"})]}),"\n",(0,r.jsx)(e.li,{children:"C\xfa ph\xe1p:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'ENTRYPOINT ["executable", "param1", "param2"]\n'})}),"\n",(0,r.jsx)(e.h3,{id:"v\xed-d\u1ee5-1",children:"V\xed d\u1ee5 1:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'FROM ubuntu\nENTRYPOINT ["echo"]\nCMD ["Hello from Docker!"]\n'})}),"\n",(0,r.jsx)(e.p,{children:"\ud83d\udc49 Khi th\u1ef1c thi:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'docker run my-image # Output: Hello from Docker!\ndocker run my-image "Custom message" # Output: Custom message\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2705 V\xec ",(0,r.jsx)(e.code,{children:"ENTRYPOINT"})," l\xe0 ",(0,r.jsx)(e.code,{children:"echo"}),", c\xf2n ",(0,r.jsx)(e.code,{children:"CMD"})," ch\u1ec9 l\xe0 tham s\u1ed1 m\u1eb7c \u0111\u1ecbnh (",(0,r.jsx)(e.code,{children:"Hello from Docker!"}),") n\u1ebfu kh\xf4ng c\xf3 g\xec \u0111\u01b0\u1ee3c ghi \u0111\xe8."]}),"\n",(0,r.jsx)(e.h3,{id:"v\xed-d\u1ee5-2",children:"V\xed d\u1ee5 2:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:'FROM python:3.10-slim\nWORKDIR /app\nCOPY script.py .\n\nENTRYPOINT ["python", "script.py"]\n'})}),"\n",(0,r.jsx)(e.p,{children:"\ud83d\udc49 Khi th\u1ef1c thi:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker run my-image arg1 arg2\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u27a1\ufe0f Docker s\u1ebd th\u1ef1c hi\u1ec7n:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"python script.py arg1 arg2\n"})}),"\n",(0,r.jsx)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["N\u1ebfu mu\u1ed1n ghi \u0111\xe8 ",(0,r.jsx)(e.code,{children:"ENTRYPOINT"}),", ta ",(0,r.jsx)(e.strong,{children:"ph\u1ea3i d\xf9ng flag"})," ",(0,r.jsx)(e.code,{children:"--entrypoint"})," khi ch\u1ea1y container."]}),"\n",(0,r.jsxs)(e.li,{children:["Trong m\u1ed9t Dockerfile ch\u1ec9 \u0111\u01b0\u1ee3c c\xf3 ",(0,r.jsx)(e.strong,{children:"1"})," ",(0,r.jsx)(e.code,{children:"ENTRYPOINT"})," , d\xf2ng sau s\u1ebd ghi \u0111\xe8 d\xf2ng tr\u01b0\u1edbc n\u1ebfu c\xf3 nhi\u1ec1u."]}),"\n"]})}),"\n",(0,r.jsx)(e.h2,{id:"run",children:"RUN"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["L\u1ec7nh ",(0,r.jsx)(e.code,{children:"RUN"})," trong Dockerfile d\xf9ng \u0111\u1ec3 ",(0,r.jsx)(e.strong,{children:"th\u1ef1c thi l\u1ec7nh trong qu\xe1 tr\xecnh build image"}),", t\u1ee9c l\xe0 l\u1ec7nh \u0111\xf3 ",(0,r.jsx)(e.strong,{children:"ch\u1ea1y t\u1ea1i th\u1eddi \u0111i\u1ec3m Docker build"}),", ",(0,r.jsx)(e.strong,{children:"kh\xf4ng ph\u1ea3i khi container ch\u1ea1y"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:["D\xf9ng ",(0,r.jsx)(e.code,{children:"RUN"})," khi:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"C\xe0i \u0111\u1eb7t ph\u1ea7n m\u1ec1m, package"}),"\n",(0,r.jsx)(e.li,{children:"Thi\u1ebft l\u1eadp m\xf4i tr\u01b0\u1eddng"}),"\n",(0,r.jsx)(e.li,{children:"Bi\xean d\u1ecbch code"}),"\n",(0,r.jsx)(e.li,{children:"D\u1ecdn d\u1eb9p file t\u1ea1m, cache"}),"\n",(0,r.jsx)(e.li,{children:"T\u1ea1o file, user, th\u01b0 m\u1ee5c c\u1ea7n thi\u1ebft"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"FROM node:18\n\n# C\xe0i th\xeam curl v\xe0 nano\nRUN apt-get update && apt-get install -y curl nano\n\n# T\u1ea1o th\u01b0 m\u1ee5c \u1ee9ng d\u1ee5ng\nRUN mkdir /app\n"})}),"\n",(0,r.jsxs)(e.admonition,{title:"L\u01b0u \xfd",type:"caution",children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["M\u1ed7i l\u1ec7nh ",(0,r.jsx)(e.code,{children:"RUN"})," t\u1ea1o ra ",(0,r.jsx)(e.strong,{children:"m\u1ed9t layer m\u1edbi"})," trong image \u2192 n\xean ",(0,r.jsx)(e.strong,{children:"g\u1ed9p c\xe1c l\u1ec7nh"})," l\u1ea1i b\u1eb1ng ",(0,r.jsx)(e.code,{children:"&&"})," \u0111\u1ec3 t\u1ed1i \u01b0u k\xedch th\u01b0\u1edbc image."]}),"\n"]}),(0,r.jsx)(e.p,{children:"\u2705 N\xean:"}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"RUN apt update && apt install -y curl git && rm -rf /var/lib/apt/lists/*\n"})}),(0,r.jsx)(e.p,{children:"\u274c Kh\xf4ng n\xean:"}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-Dockerfile",children:"RUN apt update\nRUN apt install -y curl\nRUN apt install -y git\n"})})]})]})}function a(n={}){const{wrapper:e}={...(0,h.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},8453:(n,e,c)=>{c.d(e,{R:()=>l,x:()=>s});var i=c(6540);const r={},h=i.createContext(r);function l(n){const e=i.useContext(h);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),i.createElement(h.Provider,{value:e},n.children)}}}]);