"use strict";(self.webpackChunknextjs=self.webpackChunknextjs||[]).push([[249],{4515:(n,e,d)=>{d.r(e),d.d(e,{assets:()=>s,contentTitle:()=>t,default:()=>x,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"reference/cli/docker-build","title":"docker build","description":"- C\xe2u l\u1ec7nh docker build d\xf9ng \u0111\u1ec3 t\u1ea1o m\u1ed9t image t\u1eeb Dockerfile.","source":"@site/docs/reference/cli/docker-build.md","sourceDirName":"reference/cli","slug":"/reference/cli/docker-build","permalink":"/docker/reference/cli/docker-build","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"CLI","permalink":"/docker/category/cli"},"next":{"title":"docker run","permalink":"/docker/reference/cli/docker-run"}}');var c=d(4848),r=d(8453);const l={sidebar_position:1},t="docker build",s={},h=[{value:"\ud83d\udce6 <strong>Build context l\xe0 g\xec?</strong>",id:"-build-context-l\xe0-g\xec",level:2},{value:"\ud83e\udde0 <strong>V\xed d\u1ee5 c\u1ee5 th\u1ec3:</strong>",id:"-v\xed-d\u1ee5-c\u1ee5-th\u1ec3",level:3},{value:"\u26a0\ufe0f <strong>L\u01b0u \xfd quan tr\u1ecdng v\u1ec1 build context:</strong>",id:"\ufe0f-l\u01b0u-\xfd-quan-tr\u1ecdng-v\u1ec1-build-context",level:3},{value:"\ud83d\udcc2 <strong>V\xed d\u1ee5 kh\xe1c:</strong>",id:"-v\xed-d\u1ee5-kh\xe1c",level:3},{value:"M\u1ed9t s\u1ed1 options ph\u1ed5 bi\u1ebfn",id:"m\u1ed9t-s\u1ed1-options-ph\u1ed5-bi\u1ebfn",level:2},{value:"M\u1ed9t s\u1ed1 v\xed d\u1ee5",id:"m\u1ed9t-s\u1ed1-v\xed-d\u1ee5",level:2},{value:"V\xed d\u1ee5 c\u01a1 b\u1ea3n",id:"v\xed-d\u1ee5-c\u01a1-b\u1ea3n",level:3},{value:"V\xed d\u1ee5 v\u1edbi <code>--target</code>",id:"v\xed-d\u1ee5-v\u1edbi---target",level:3}];function o(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"docker-build",children:"docker build"})}),"\n",(0,c.jsxs)(e.admonition,{type:"info",children:[(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["C\xe2u l\u1ec7nh ",(0,c.jsx)(e.code,{children:"docker build"})," d\xf9ng \u0111\u1ec3 t\u1ea1o m\u1ed9t image t\u1eeb Dockerfile."]}),"\n",(0,c.jsx)(e.li,{children:"C\u1ea5u tr\xfac c\xe2u l\u1ec7nh:"}),"\n"]}),(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"docker build [OPTIONS] [BUILD_CONTEXT]\n"})})]}),"\n",(0,c.jsxs)(e.h2,{id:"-build-context-l\xe0-g\xec",children:["\ud83d\udce6 ",(0,c.jsx)(e.strong,{children:"Build context l\xe0 g\xec?"})]}),"\n",(0,c.jsxs)(e.p,{children:["Build context l\xe0 ",(0,c.jsx)(e.strong,{children:"to\xe0n b\u1ed9 n\u1ed9i dung th\u01b0 m\u1ee5c"})," m\xe0 Docker s\u1ebd d\xf9ng \u0111\u1ec3 ",(0,c.jsx)(e.strong,{children:"copy v\xe0o trong qu\xe1 tr\xecnh build image"})," . N\xf3 bao g\u1ed3m:"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"Dockerfile"})," (n\u1ebfu kh\xf4ng ch\u1ec9 \u0111\u1ecbnh ri\xeang qua ",(0,c.jsx)(e.code,{children:"-f"}),")"]}),"\n",(0,c.jsxs)(e.li,{children:["C\xe1c file m\xe0 ",(0,c.jsx)(e.code,{children:"Dockerfile"})," s\u1ebd s\u1eed d\u1ee5ng v\u1edbi c\xe2u l\u1ec7nh nh\u01b0 ",(0,c.jsx)(e.code,{children:"COPY"}),", ",(0,c.jsx)(e.code,{children:"ADD"}),", v.v."]}),"\n",(0,c.jsx)(e.li,{children:"C\xe1c th\u01b0 m\u1ee5c con, file c\u1ea5u h\xecnh, v.v."}),"\n"]}),"\n",(0,c.jsxs)(e.h3,{id:"-v\xed-d\u1ee5-c\u1ee5-th\u1ec3",children:["\ud83e\udde0 ",(0,c.jsx)(e.strong,{children:"V\xed d\u1ee5 c\u1ee5 th\u1ec3:"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"docker build -t myapp:latest .\n"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["D\u1ea5u ",(0,c.jsx)(e.code,{children:'"."'})," ngh\u0129a l\xe0 th\u01b0 m\u1ee5c hi\u1ec7n t\u1ea1i ch\xednh l\xe0 ",(0,c.jsx)(e.strong,{children:"build context"})," ."]}),"\n",(0,c.jsx)(e.li,{children:"Docker s\u1ebd g\u1eedi to\xe0n b\u1ed9 n\u1ed9i dung th\u01b0 m\u1ee5c hi\u1ec7n t\u1ea1i \u0111\u1ebfn Docker daemon \u0111\u1ec3 d\xf9ng trong qu\xe1 tr\xecnh build."}),"\n"]}),"\n",(0,c.jsxs)(e.h3,{id:"\ufe0f-l\u01b0u-\xfd-quan-tr\u1ecdng-v\u1ec1-build-context",children:["\u26a0\ufe0f ",(0,c.jsx)(e.strong,{children:"L\u01b0u \xfd quan tr\u1ecdng v\u1ec1 build context:"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"Ch\u1ec9 nh\u1eefng file trong build context m\u1edbi c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c truy c\u1eadp t\u1eeb Dockerfile."})}),"\n",(0,c.jsxs)(e.p,{children:["\u2192 N\u1ebfu file n\u1eb1m ngo\xe0i th\u01b0 m\u1ee5c build context, b\u1ea1n ",(0,c.jsxs)(e.strong,{children:["kh\xf4ng th\u1ec3 ",(0,c.jsx)(e.code,{children:"COPY"})," ho\u1eb7c ",(0,c.jsx)(e.code,{children:"ADD"})]})," n\xf3 v\xe0o trong image."]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"Build context c\xe0ng l\u1edbn th\xec qu\xe1 tr\xecnh build c\xe0ng ch\u1eadm"})," , v\xec Docker ph\u1ea3i n\xe9n & g\u1eedi to\xe0n b\u1ed9 n\u1ed9i dung \u0111\u1ebfn daemon \u2192 n\xean d\xf9ng ",(0,c.jsx)(e.code,{children:".dockerignore"})," \u0111\u1ec3 lo\u1ea1i tr\u1eeb file kh\xf4ng c\u1ea7n thi\u1ebft."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.h3,{id:"-v\xed-d\u1ee5-kh\xe1c",children:["\ud83d\udcc2 ",(0,c.jsx)(e.strong,{children:"V\xed d\u1ee5 kh\xe1c:"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"docker build -t backend:v1 ./server\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u2192 Build context l\xe0 th\u01b0 m\u1ee5c ",(0,c.jsx)(e.code,{children:"./server"}),", ch\u1ee9 kh\xf4ng ph\u1ea3i th\u01b0 m\u1ee5c hi\u1ec7n t\u1ea1i."]}),"\n",(0,c.jsx)(e.h2,{id:"m\u1ed9t-s\u1ed1-options-ph\u1ed5-bi\u1ebfn",children:"M\u1ed9t s\u1ed1 options ph\u1ed5 bi\u1ebfn"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"Option"}),(0,c.jsx)(e.th,{children:"\xdd ngh\u0129a"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"-t"}),",",(0,c.jsx)(e.code,{children:"--tag"})]}),(0,c.jsxs)(e.td,{children:["G\xe1n t\xean v\xe0 tag cho image, v\xed d\u1ee5 ",(0,c.jsx)(e.code,{children:"myapp:latest"})]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"-f"}),",",(0,c.jsx)(e.code,{children:"--file"})]}),(0,c.jsxs)(e.td,{children:["Ch\u1ec9 \u0111\u1ecbnh \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ebfn Dockerfile n\u1ebfu kh\xf4ng n\u1eb1m \u1edf m\u1eb7c \u0111\u1ecbnh (",(0,c.jsx)(e.code,{children:"./Dockerfile"}),")"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"--no-cache"})}),(0,c.jsx)(e.td,{children:"B\u1ecf qua cache trong qu\xe1 tr\xecnh build (s\u1ebd build t\u1eeb \u0111\u1ea7u)"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"--build-arg"})}),(0,c.jsxs)(e.td,{children:["Truy\u1ec1n bi\u1ebfn m\xf4i tr\u01b0\u1eddng (",(0,c.jsx)(e.code,{children:"ARG"}),") v\xe0o Dockerfile"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"--platform"})}),(0,c.jsxs)(e.td,{children:["X\xe1c \u0111\u1ecbnh n\u1ec1n t\u1ea3ng c\u1ea7n build (v\xed d\u1ee5:",(0,c.jsx)(e.code,{children:"linux/amd64"}),",",(0,c.jsx)(e.code,{children:"linux/arm64"}),")"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"--target"})}),(0,c.jsxs)(e.td,{children:["Build \u0111\u1ebfn m\u1ed9t ",(0,c.jsx)(e.code,{children:"stage"})," c\u1ee5 th\u1ec3 trong Dockerfile multi-stage"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"--pull"})}),(0,c.jsx)(e.td,{children:"Lu\xf4n k\xe9o phi\xean b\u1ea3n m\u1edbi nh\u1ea5t c\u1ee7a base image"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"--quiet"}),",",(0,c.jsx)(e.code,{children:"-q"})]}),(0,c.jsx)(e.td,{children:"Ch\u1ec9 hi\u1ec3n th\u1ecb image ID sau khi build xong (im l\u1eb7ng)"})]})]})]}),"\n",(0,c.jsx)(e.h2,{id:"m\u1ed9t-s\u1ed1-v\xed-d\u1ee5",children:"M\u1ed9t s\u1ed1 v\xed d\u1ee5"}),"\n",(0,c.jsx)(e.h3,{id:"v\xed-d\u1ee5-c\u01a1-b\u1ea3n",children:"V\xed d\u1ee5 c\u01a1 b\u1ea3n"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"# Build image t\u1eeb Dockerfile trong th\u01b0 m\u1ee5c hi\u1ec7n t\u1ea1i v\xe0 g\u1eafn tag myapp:latest.\ndocker build -t myapp:latest .\n\n# Ch\u1ec9 \u0111\u1ecbnh Dockerfile ri\xeang n\u1eb1m trong th\u01b0 m\u1ee5c ./docker.\ndocker build -f ./docker/prod.Dockerfile -t myapp:prod .\n\n# B\u1ecf qua cache khi build.\ndocker build --no-cache -t myapp:no-cache .\n\n# Truy\u1ec1n bi\u1ebfn NODE_ENV v\xe0o Dockerfile th\xf4ng qua ARG.\ndocker build --build-arg NODE_ENV=production -t myapp:env .\n"})}),"\n",(0,c.jsxs)(e.h3,{id:"v\xed-d\u1ee5-v\u1edbi---target",children:["V\xed d\u1ee5 v\u1edbi ",(0,c.jsx)(e.code,{children:"--target"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"Gi\u1ea3 s\u1eed ta c\xf3 Dockerfile nh\u01b0 sau:"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-Dockerfile",children:'# Stage 1\nFROM node:18 AS stage1\nRUN echo ">> Running stage1"\n\n# Stage 2\nFROM alpine AS stage2\nRUN echo ">> Running stage2"\n\n# Stage 3\nFROM ubuntu AS stage3\nRUN echo ">> Running stage3"\n'})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"Ch\u1ea1y l\u1ec7nh"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"docker build --target stage2 -t test:stage2 .\n"})}),"\n",(0,c.jsx)(e.p,{children:"\ud83d\udce6 K\u1ebft qu\u1ea3:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"stage1"})," \u0111\u01b0\u1ee3c build \u2705"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"stage2"})," \u0111\u01b0\u1ee3c build \u2705"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"stage3"})," s\u1ebd ",(0,c.jsx)(e.strong,{children:"kh\xf4ng \u0111\u01b0\u1ee3c build"})," \u274c"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsxs)(e.strong,{children:["\ud83d\udca1 Khi n\xe0o n\xean d\xf9ng ",(0,c.jsx)(e.code,{children:"--target"}),"?"]})}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"T\xecnh hu\u1ed1ng"}),(0,c.jsx)(e.th,{children:"L\u1ee3i \xedch"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Ki\u1ec3m tra t\u1eebng b\u01b0\u1edbc c\u1ee7a build"}),(0,c.jsx)(e.td,{children:"D\u1ec5 debug"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Cache nhanh h\u01a1n"}),(0,c.jsx)(e.td,{children:"Kh\xf4ng c\u1ea7n build to\xe0n b\u1ed9"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"D\xf9ng stage trung gian \u0111\u1ec3 test ho\u1eb7c deploy t\u1ea1m"}),(0,c.jsx)(e.td,{children:"Ti\u1ec7n l\u1ee3i, ti\u1ebft ki\u1ec7m th\u1eddi gian"})]})]})]})]})}function x(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(o,{...n})}):o(n)}},8453:(n,e,d)=>{d.d(e,{R:()=>l,x:()=>t});var i=d(6540);const c={},r=i.createContext(c);function l(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);