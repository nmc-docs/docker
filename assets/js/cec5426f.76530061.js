"use strict";(self.webpackChunknextjs=self.webpackChunknextjs||[]).push([[929],{8453:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>s});var r=t(6540);const c={},i=r.createContext(c);function o(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:o(n.components),r.createElement(i.Provider,{value:e},n.children)}},9067:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"docker-compose/structure","title":"C\u1ea5u tr\xfac c\u01a1 b\u1ea3n c\u1ee7a file Docker Compose","description":"- Ta c\xf3 th\u1ec3 ho\u1eb7c ch\u1ec9 \u0111\u1ecbnh ri\xeang l\u1ebb t\u1eebng bi\u1ebfn m\xf4i tr\u01b0\u1eddng th\xf4ng qua environment ho\u1eb7c ch\u1ec9 \u0111\u1ecbnh \u0111\u01b0\u1eddng d\u1eabn file .env ch\u1ee9a t\u1ea5t c\u1ea3 c\xe1c bi\u1ebfn m\xf4i tr\u01b0\u1eddng trong qu\xe1 tr\xecnh run container (run time) th\xf4ng qua env_file.","source":"@site/docs/docker-compose/structure.md","sourceDirName":"docker-compose","slug":"/docker-compose/structure","permalink":"/docker/docker-compose/structure","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Gi\u1edbi thi\u1ec7u v\u1ec1 Docker Compose","permalink":"/docker/docker-compose/introduce"},"next":{"title":"CLI","permalink":"/docker/category/cli"}}');var c=t(4848),i=t(8453);const o={sidebar_position:2},s="C\u1ea5u tr\xfac c\u01a1 b\u1ea3n c\u1ee7a file Docker Compose",a={},d=[];function l(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"c\u1ea5u-tr\xfac-c\u01a1-b\u1ea3n-c\u1ee7a-file-docker-compose",children:"C\u1ea5u tr\xfac c\u01a1 b\u1ea3n c\u1ee7a file Docker Compose"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-yaml",children:'version: "3.8"\n\nservices:\n  chat_server:\n    depends_on:\n      - mysql_server\n      - redis_server\n    container_name: chat_server\n    restart: always\n    build:\n      context: ../../ # T\xednh t\u1eeb v\u1ecb tr\xed c\u1ee7a file docker-compose.yaml\n      dockerfile: docker/prod/Dockerfile # T\xednh t\u1eeb th\u01b0 m\u1ee5c context nh\u01b0 \u0111\xe3 c\u1ea5u h\xecnh c\u1ea5u h\xecnh \u1edf d\xf2ng tr\xean\n    environment:\n      - NODE_ENV=production\n    env_file: .env.prod # T\xednh t\u1eeb v\u1ecb tr\xed c\u1ee7a file docker-compose.yaml\n    networks:\n      - web_chat_networks\n    stdin_open: true\n    tty: true\n    ports:\n      - "8000:8080"\n\n  mysql_server:\n    image: mysql:latest\n    container_name: mysql_server\n    restart: always\n    environment:\n      - MYSQL_DATABASE=${MYSQL_DATABASE_NAME}\n      - MYSQL_ROOT_PASSWORD=${MYSQL_PASSWORD}\n    ports:\n      - ${MYSQL_LOCAL_PORT}:${MYSQL_DOCKER_PORT}\n    volumes:\n      - ./data/mysql:/var/lib/mysql # Path t\xednh t\u1eeb v\u1ecb tr\xed c\u1ee7a file docker-compose.yaml\n    networks:\n      - web_chat_networks\n\n  redis_server:\n    image: redis:7.2-alpine\n    command: redis-server --requirepass ${REDIS_PASSWORD}\n    container_name: redis_server\n    restart: always\n    ports:\n      - ${REDIS_LOCAL_PORT}:${REDIS_DOCKER_PORT}\n    volumes:\n      - redis-data:/data\n    networks:\n      - web_chat_networks\n\nnetworks:\n  web_chat_networks:\n    driver: bridge\n'})}),"\n",(0,c.jsxs)(e.admonition,{type:"note",children:[(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["Ta c\xf3 th\u1ec3 ho\u1eb7c ch\u1ec9 \u0111\u1ecbnh ri\xeang l\u1ebb t\u1eebng bi\u1ebfn m\xf4i tr\u01b0\u1eddng th\xf4ng qua ",(0,c.jsx)(e.code,{children:"environment"})," ho\u1eb7c ch\u1ec9 \u0111\u1ecbnh \u0111\u01b0\u1eddng d\u1eabn file .env ch\u1ee9a t\u1ea5t c\u1ea3 c\xe1c bi\u1ebfn m\xf4i tr\u01b0\u1eddng trong qu\xe1 tr\xecnh run container (run time) th\xf4ng qua ",(0,c.jsx)(e.code,{children:"env_file"}),"."]}),"\n",(0,c.jsxs)(e.li,{children:["Bi\u1ebfn m\xf4i tr\u01b0\u1eddng m\xe0 ta c\u1ea5u h\xecnh trong t\u1eebng services ch\xednh ",(0,c.jsx)(e.strong,{children:"l\xe0 c\xe1c bi\u1ebfn m\xf4i tr\u01b0\u1eddng s\u1ebd \u0111\u01b0\u1ee3c inject khi ta CH\u1ea0Y container (run time), ch\u1ee9 kh\xf4ng ph\u1ea3i trong qu\xe1 tr\xecnh build image (build time nh\u01b0 c\xe1c \u1ee9ng d\u1ee5ng ReactJs, VueJS,...)."}),". N\xf3 ph\xf9 h\u1ee3p khi service l\xe0 m\xf4i tr\u01b0\u1eddng server NodeJS, ch\u1ee9 kh\xf4ng ph\xf9 h\u1ee3p v\u1edbi m\xf4i tr\u01b0\u1eddng client-side (ReactJS, VueJS), n\u01a1i m\xe0 bi\u1ebfn m\xf4i tr\u01b0\u1eddng ph\u1ea3i \u0111\u01b0\u1ee3c inject trong qu\xe1 tr\xecnh build image."]}),"\n",(0,c.jsxs)(e.li,{children:["N\u1ebfu ta mu\u1ed1n s\u1eed d\u1ee5ng bi\u1ebfn m\xf4i tr\u01b0\u1eddng trong khi build c\xe1c \u1ee9ng d\u1ee5ng front-end (ReactJS, VueJS), h\xe3y s\u1eed d\u1ee5ng ",(0,c.jsx)(e.a,{href:"../reference/docker-file#k%E1%BA%BFt-h%E1%BB%A3p-v%E1%BB%9Bi-env",children:"ARG"}),", v\xec n\xf3 s\u1ebd \u0111\u01b0\u1ee3c inject t\u1ea1i th\u1eddi \u0111i\u1ec3m build image, ch\u1ee9 kh\xf4ng ph\u1ea3i khi run container (image \u0111\xe3 \u0111\u01b0\u1ee3c build r\u1ed3i). L\xfac n\xe0y file docker compose c\u1ee7a ta s\u1ebd c\xf3 d\u1ea1ng nh\u01b0:"]}),"\n"]}),(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-yaml",children:'services:\n  web_chat_client:\n    container_name: web_chat_client\n    build:\n      context: ../../\n      dockerfile: docker/prod/Dockerfile\n      args:\n        - VITE_API_URL=http://localhost:3001\n        - VITE_SOCKET_URL=http://localhost:3001\n    ports:\n      - "3000:3000"\n    restart: unless-stopped\n'})})]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(l,{...n})}):l(n)}}}]);